import{Camera}from'./Camera.js';import{Object3D}from'../core/Object3D.js';import{_Math}from'../math/Math.js';function PerspectiveCamera(a,b,c,d){Camera.call(this),this.type='PerspectiveCamera',this.fov=a===void 0?50:a,this.zoom=1,this.near=c===void 0?0.1:c,this.far=d===void 0?2e3:d,this.focus=10,this.aspect=b===void 0?1:b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}PerspectiveCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:PerspectiveCamera,isPerspectiveCamera:!0,copy:function(a){return Camera.prototype.copy.call(this,a),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this},setFocalLength:function(a){var b=0.5*this.getFilmHeight()/a;this.fov=2*_Math.RAD2DEG*Math.atan(b),this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(0.5*_Math.DEG2RAD*this.fov);return 0.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*_Math.RAD2DEG*Math.atan(Math.tan(0.5*_Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b,this.view={fullWidth:a,fullHeight:b,offsetX:c,offsetY:d,width:e,height:f},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(0.5*_Math.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-0.5*d,f=this.view;if(null!==f){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g,b-=f.offsetY*c/h,d*=f.width/g,c*=f.height/h}var i=this.filmOffset;0!==i&&(e+=a*i/this.getFilmWidth()),this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far)},toJSON:function(a){var b=Object3D.prototype.toJSON.call(this,a);return b.object.fov=this.fov,b.object.zoom=this.zoom,b.object.near=this.near,b.object.far=this.far,b.object.focus=this.focus,b.object.aspect=this.aspect,null!==this.view&&(b.object.view=Object.assign({},this.view)),b.object.filmGauge=this.filmGauge,b.object.filmOffset=this.filmOffset,b}});export{PerspectiveCamera};