import{Path}from'./Path.js';import{Shape}from'./Shape.js';import{ShapeUtils}from'../ShapeUtils.js';function ShapePath(){this.subPaths=[],this.currentPath=null}Object.assign(ShapePath.prototype,{moveTo:function(a,b){this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new Shape;f.curves=e.curves,b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],i=h.x-g.x,j=h.y-g.y;if(Math.abs(j)>Number.EPSILON){if(0>j&&(g=b[f],i=-i,h=b[e],j=-j),a.y<g.y||a.y>h.y)continue;if(a.y!==g.y){var k=j*(a.x-g.x)-i*(a.y-g.y);if(0==k)return!0;if(0>k)continue;d=!d}else if(a.x===g.x)return!0}else{if(a.y!==g.y)continue;if(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x)return!0}}return d}var e=ShapeUtils.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);var g,h,k,m=[];if(1===f.length)return h=f[0],k=new Shape,k.curves=h.curves,m.push(k),m;var n=!e(f[0].getPoints());n=a?!n:n;var o,p=[],q=[],r=[],s=0;q[s]=void 0,r[s]=[];for(var t=0,i=f.length;t<i;t++)h=f[t],o=h.getPoints(),g=e(o),g=a?!g:g,g?(!n&&q[s]&&s++,q[s]={s:new Shape,p:o},q[s].s.curves=h.curves,n&&s++,r[s]=[]):r[s].push({h:h,p:o[0]});if(!q[0])return c(f);if(1<q.length){for(var l=!1,u=[],v=0,w=q.length;v<w;v++)p[v]=[];for(var x,v=0,w=q.length;v<w;v++){x=r[v];for(var y=0;y<x.length;y++){for(var z=x[y],A=!0,B=0;B<q.length;B++)d(z.p,q[B].p)&&(v!==B&&u.push({froms:v,tos:B,hole:y}),A?(A=!1,p[B].push(z)):l=!0);A&&p[v].push(z)}}0<u.length&&!l&&(r=p)}for(var C,t=0,D=q.length;t<D;t++){k=q[t].s,m.push(k),C=r[t];for(var E=0,j=C.length;E<j;E++)k.holes.push(C[E].h)}return m}});export{ShapePath};