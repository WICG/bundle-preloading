import{Matrix3}from'../../math/Matrix3.js';import{Plane}from'../../math/Plane.js';function WebGLClipping(){function a(){k.value!==d&&(k.value=d,k.needsUpdate=0<e),c.numPlanes=e,c.numIntersection=0}function b(a,b,d,e){var f=null===a?0:a.length,g=null;if(0!==f){if(g=k.value,!0!==e||null===g){var l=d+4*f,m=b.matrixWorldInverse;j.getNormalMatrix(m),(null===g||g.length<l)&&(g=new Float32Array(l));for(var n=0,i=d;n!==f;++n,i+=4)h.copy(a[n]).applyMatrix4(m,j),h.normal.toArray(g,i),g[i+3]=h.constant}k.value=g,k.needsUpdate=!0}return c.numPlanes=f,g}var c=this,d=null,e=0,f=!1,g=!1,h=new Plane,j=new Matrix3,k={value:null,needsUpdate:!1};this.uniform=k,this.numPlanes=0,this.numIntersection=0,this.init=function(a,c,g){var h=0!==a.length||c||0!=e||f;return f=c,d=b(a,g,0),e=a.length,h},this.beginShadows=function(){g=!0,b(null)},this.endShadows=function(){g=!1,a()},this.setState=function(c,h,j,l,m,n){if(!f||null===c||0===c.length||g&&!j)g?b(null):a();else{var o=g?0:e,p=4*o,q=m.clippingState||null;k.value=q,q=b(c,l,p,n);for(var r=0;r!==p;++r)q[r]=d[r];m.clippingState=q,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=o}}}export{WebGLClipping};